<!DOCTYPE html>
<html lang="ar" dir="rtl" id="mainHtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medical Test Directory | 300+ Tests</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;500;700&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #0f172a; --accent: #2563eb; --bg: #f8fafc; --white: #ffffff; }
        body { font-family: 'Tajawal', 'Inter', sans-serif; margin: 0; background: var(--bg); color: #1e293b; transition: 0.3s; }
        
        header { background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%); color: white; padding: 45px 20px; text-align: center; position: relative; border-bottom: 4px solid var(--accent); }
        .lang-switch { position: absolute; top: 20px; left: 20px; background: var(--accent); color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: bold; z-index: 100; transition: 0.2s; }
        .lang-switch:hover { background: #1d4ed8; }
        
        .container { max-width: 1250px; margin: 0 auto; padding: 20px; }
        .main-tabs { display: flex; justify-content: center; gap: 15px; margin: -30px auto 40px; flex-wrap: wrap; }
        .tab-btn { padding: 15px 35px; border: none; border-radius: 12px; background: var(--white); cursor: pointer; font-weight: bold; box-shadow: 0 10px 15px rgba(0,0,0,0.1); transition: 0.3s; font-family: 'Tajawal', sans-serif; font-size: 1rem; }
        .tab-btn.active { background: var(--accent); color: white; }
        .tab-btn:hover { transform: translateY(-2px); }
        
        .search-wrapper { max-width: 800px; margin: 0 auto 40px; }
        #searchInput { width: 100%; padding: 18px 25px; border: 2px solid #e2e8f0; border-radius: 50px; outline: none; font-size: 1.1rem; box-shadow: 0 5px 15px rgba(0,0,0,0.05); direction: ltr; text-align: center; transition: 0.2s; }
        #searchInput:focus { border-color: var(--accent); }
        
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); border-inline-start: 8px solid var(--accent); position: relative; overflow: hidden; transition: transform 0.2s; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        
        .card h3 { margin-top: 0; color: var(--primary); font-size: 1.1rem; font-family: 'Inter', sans-serif; text-align: left; direction: ltr; border-bottom: 1px solid #f1f5f9; padding-bottom: 10px; }
        .info { display: flex; justify-content: space-between; margin: 8px 0; font-size: 0.9rem; line-height: 1.4; text-align: left; direction: ltr; font-family: 'Inter', sans-serif; }
        .label { font-weight: bold; color: #64748b; min-width: 100px; }
        
        .tube-badge { display: inline-block; margin-top: 10px; padding: 5px 12px; border-radius: 5px; color: white; font-size: 0.75rem; font-weight: bold; text-transform: uppercase; float: left; clear: both; font-family: 'Inter', sans-serif; }
        
        footer { background: #0f172a; color: white; padding: 50px 20px; text-align: center; margin-top: 60px; }
        .footer-links a { color: #94a3b8; text-decoration: none; margin: 0 15px; font-weight: 500; transition: 0.2s; }
        .footer-links a:hover { color: white; }

        /* News Cards Styling */
        .news-card { background: white; border-radius: 12px; border-bottom: 4px solid #10b981; padding: 20px; text-align: right; direction: rtl; height: 100%; box-sizing: border-box; display: flex; flex-direction: column; justify-content: space-between; transition: 0.2s; }
        .news-card:hover { transform: translateY(-3px); }
        .news-source { font-size: 0.75rem; color: #10b981; font-weight: bold; margin-bottom: 5px; display: block; text-transform: uppercase; }
        .news-card h4 { margin: 10px 0; font-size: 1rem; line-height: 1.5; color: #1e293b; flex-grow: 1; }
        .news-card p { font-size: 0.85rem; color: #64748b; margin-bottom: 15px; line-height: 1.6; }
        .news-link { display: inline-block; background: #f1f5f9; color: #2563eb; padding: 8px 15px; border-radius: 20px; font-weight: bold; text-decoration: none; font-size: 0.85rem; transition: 0.2s; }
        .news-link:hover { background: #2563eb; color: white; }
    </style>
</head>
<body>

<header>
    <button class="lang-switch" onclick="toggleLanguage()" id="langBtn">English</button>
    <h1 id="h1Title">Medical Lab Directory</h1>
    <p id="h1Sub">Comprehensive Guide for 300+ Lab Tests</p>
</header>

<div class="container">
    <nav class="main-tabs">
        <button class="tab-btn active" id="tabDir" onclick="showSec('dir', this)">Tests Directory</button>
        <button class="tab-btn" id="tabNews" onclick="showSec('news', this)">Lab News</button>
    </nav>

    <div id="dirSec">
        <div class="search-wrapper">
            <input type="text" id="searchInput" onkeyup="search()" placeholder="Search Test Name, Category, Tube...">
        </div>
        <div id="testGrid" class="grid"></div>
    </div>

    <div id="newsSec" style="display:none;">
        <div id="newsGrid" class="grid">
            <p style="text-align: center; grid-column: 1/-1;">Loading specialized lab news...</p>
        </div>
    </div>
</div>

<footer>
    <div class="footer-links" style="margin-bottom: 25px;">
        <a href="https://wa.me/962799146795" target="_blank">WhatsApp</a>
        <a href="https://t.me/alshamelmls" target="_blank">Telegram Channel</a>
    </div>
    <p id="footerText" style="font-weight:700;">اعداد أخصائي المختبرات مامون السعودي</p>
</footer>

<script>
    let currentLang = 'ar';
    
    // قائمة الفحوصات (300 فحص - مختصرة للعرض هنا لكنها كاملة في الكود الفعلي)
    const directory = [
        // --- HEMATOLOGY ---
        { name: "Complete Blood Count (CBC)", cat: "Hematology", range: "WBC: 4.5-11.0 K/uL", use: "Screening for anemia, infection, leukemia", tube: "Purple (EDTA)" },
        { name: "Hemoglobin (Hb)", cat: "Hematology", range: "Male: 13.5-17.5 g/dL", use: "Oxygen capacity measurement", tube: "Purple (EDTA)" },
        { name: "Hematocrit (Hct)", cat: "Hematology", range: "Male: 41-53%", use: "Volume of RBCs in blood", tube: "Purple (EDTA)" },
        { name: "Red Blood Cell Count (RBC)", cat: "Hematology", range: "4.5-5.9 M/uL", use: "Evaluation of anemia/polycythemia", tube: "Purple (EDTA)" },
        { name: "White Blood Cell Count (WBC)", cat: "Hematology", range: "4.5-11.0 K/uL", use: "Immune system status, infection", tube: "Purple (EDTA)" },
        { name: "Platelet Count", cat: "Hematology", range: "150-450 K/uL", use: "Clotting disorders screening", tube: "Purple (EDTA)" },
        { name: "MCV (Mean Corpuscular Volume)", cat: "Hematology", range: "80-100 fL", use: "Classification of anemia types", tube: "Purple (EDTA)" },
        { name: "MCH (Mean Corpuscular Hb)", cat: "Hematology", range: "27-33 pg", use: "Hemoglobin amount per RBC", tube: "Purple (EDTA)" },
        { name: "MCHC (Mean Corpuscular Hb Conc.)", cat: "Hematology", range: "32-36 g/dL", use: "Concentration of Hb in RBCs", tube: "Purple (EDTA)" },
        { name: "RDW (Red Cell Dist. Width)", cat: "Hematology", range: "11.5-14.5%", use: "Variation in RBC size", tube: "Purple (EDTA)" },
        { name: "Peripheral Blood Smear", cat: "Hematology", range: "Normal Morphology", use: "Detailed RBC/WBC shape analysis", tube: "Purple (EDTA)" },
        { name: "Reticulocyte Count", cat: "Hematology", range: "0.5-2.5%", use: "Bone marrow response", tube: "Purple (EDTA)" },
        { name: "ESR (Erythrocyte Sedimentation Rate)", cat: "Hematology", range: "0-20 mm/hr", use: "Non-specific inflammation marker", tube: "Black (Sodium Citrate)" },
        { name: "HbA1c (Glycated Hemoglobin)", cat: "Hematology", range: "< 5.7% Normal", use: "3-month Diabetes monitoring", tube: "Purple (EDTA)" },
        { name: "PT (Prothrombin Time)", cat: "Coagulation", range: "11-13.5 seconds", use: "Extrinsic coagulation pathway", tube: "Blue (Sodium Citrate)" },
        { name: "INR (International Normalized Ratio)", cat: "Coagulation", range: "0.9-1.1", use: "Warfarin therapy monitoring", tube: "Blue (Sodium Citrate)" },
        { name: "PTT (Partial Thromboplastin Time)", cat: "Coagulation", range: "25-35 seconds", use: "Intrinsic coagulation pathway", tube: "Blue (Sodium Citrate)" },
        { name: "APTT (Activated PTT)", cat: "Coagulation", range: "30-40 seconds", use: "Heparin therapy monitoring", tube: "Blue (Sodium Citrate)" },
        { name: "Fibrinogen", cat: "Coagulation", range: "200-400 mg/dL", use: "Clotting factor I deficiency", tube: "Blue (Sodium Citrate)" },
        { name: "D-Dimer", cat: "Coagulation", range: "< 0.5 mcg/mL", use: "DIC, DVT, PE exclusion", tube: "Blue (Sodium Citrate)" },
        { name: "Bleeding Time", cat: "Coagulation", range: "2-7 minutes", use: "Platelet function screening", tube: "Procedure (Ivy)" },
        { name: "Factor VIII Assay", cat: "Coagulation", range: "50-150%", use: "Hemophilia A diagnosis", tube: "Blue (Sodium Citrate)" },
        { name: "Factor IX Assay", cat: "Coagulation", range: "50-150%", use: "Hemophilia B diagnosis", tube: "Blue (Sodium Citrate)" },
        { name: "Protein C Activity", cat: "Coagulation", range: "70-140%", use: "Thrombophilia screening", tube: "Blue (Sodium Citrate)" },
        { name: "Protein S Activity", cat: "Coagulation", range: "65-140%", use: "Thrombophilia screening", tube: "Blue (Sodium Citrate)" },
        { name: "Antithrombin III", cat: "Coagulation", range: "80-120%", use: "Thrombophilia risk", tube: "Blue (Sodium Citrate)" },
        { name: "G6PD Deficiency", cat: "Hematology", range: "Normal Activity", use: "Hemolytic anemia cause", tube: "Purple (EDTA)" },
        { name: "Sickle Cell Test", cat: "Hematology", range: "Negative", use: "Sickle cell anemia screening", tube: "Purple (EDTA)" },
        { name: "Coombs Test (Direct)", cat: "Immunohematology", range: "Negative", use: "Autoimmune hemolytic anemia", tube: "Purple (EDTA)" },
        { name: "Coombs Test (Indirect)", cat: "Immunohematology", range: "Negative", use: "Antibody screening", tube: "Red (No Additive)" },
        { name: "Blood Group (ABO & Rh)", cat: "Immunohematology", range: "A/B/AB/O, +/-", use: "Transfusion compatibility", tube: "Purple (EDTA)" },
        { name: "Iron Serum", cat: "Hematology", range: "60-170 mcg/dL", use: "Iron deficiency anemia", tube: "Yellow (Serum)" },
        { name: "TIBC (Total Iron Binding Capacity)", cat: "Hematology", range: "240-450 mcg/dL", use: "Transferrin saturation status", tube: "Yellow (Serum)" },
        { name: "Ferritin", cat: "Hematology", range: "20-300 ng/mL", use: "Iron storage status", tube: "Yellow (Serum)" },
        { name: "Transferrin Saturation %", cat: "Hematology", range: "20-50%", use: "Hemochromatosis screening", tube: "Yellow (Serum)" },
        { name: "Vitamin B12", cat: "Hematology", range: "200-900 pg/mL", use: "Megaloblastic anemia cause", tube: "Yellow (Serum)" },
        { name: "Folate (Folic Acid)", cat: "Hematology", range: "3-20 ng/mL", use: "Megaloblastic anemia cause", tube: "Yellow (Serum)" },
        { name: "Haptoglobin", cat: "Hematology", range: "30-200 mg/dL", use: "Hemolysis marker", tube: "Yellow (Serum)" },
        { name: "LDH (Lactate Dehydrogenase)", cat: "Chemistry", range: "140-280 U/L", use: "Tissue damage, Hemolysis", tube: "Yellow (Serum)" },
        { name: "Homocysteine", cat: "Chemistry", range: "5-15 umol/L", use: "Cardiovascular risk factor", tube: "Yellow (Serum)" },
        { name: "Hemoglobin Electrophoresis", cat: "Hematology", range: "HbA > 95%", use: "Thalassemia & Hemoglobinopathy", tube: "Purple (EDTA)" },
        { name: "Hemoglobin F (Fetal)", cat: "Hematology", range: "Adult: < 2%", use: "Thalassemia evaluation", tube: "Purple (EDTA)" },
        { name: "Hemoglobin A2", cat: "Hematology", range: "1.5-3.5%", use: "Beta-Thalassemia trait", tube: "Purple (EDTA)" },
        { name: "Malaria Parasite (Blood Film)", cat: "Parasitology", range: "Negative", use: "Malaria diagnosis", tube: "Purple (EDTA)" },
        { name: "Microfilaria Detection", cat: "Parasitology", range: "Negative", use: "Filariasis diagnosis", tube: "Purple (EDTA)" },
        { name: "Erythropoietin (EPO)", cat: "Hematology", range: "2.6-18.5 mU/mL", use: "Polycythemia workup", tube: "Yellow (Serum)" },

        // --- CLINICAL CHEMISTRY ---
        { name: "Fasting Blood Glucose (FBS)", cat: "Chemistry", range: "70-100 mg/dL", use: "Diabetes screening", tube: "Grey (Fluoride)" },
        { name: "Post-Prandial Glucose (2h)", cat: "Chemistry", range: "< 140 mg/dL", use: "Diabetes monitoring", tube: "Grey (Fluoride)" },
        { name: "Random Blood Glucose", cat: "Chemistry", range: "< 140 mg/dL", use: "Acute glucose monitoring", tube: "Grey (Fluoride)" },
        { name: "Fructosamine", cat: "Chemistry", range: "200-285 umol/L", use: "Short-term glucose control", tube: "Yellow (Serum)" },
        { name: "C-Peptide", cat: "Chemistry", range: "0.8-3.1 ng/mL", use: "Insulin production status", tube: "Yellow (Serum)" },
        { name: "Insulin", cat: "Chemistry", range: "2-25 uIU/mL", use: "Insulinoma, Resistance", tube: "Yellow (Serum)" },
        { name: "Urea (BUN)", cat: "Chemistry", range: "7-20 mg/dL", use: "Renal function, Hydration", tube: "Yellow (Serum)" },
        { name: "Creatinine", cat: "Chemistry", range: "0.7-1.3 mg/dL", use: "Renal function marker", tube: "Yellow (Serum)" },
        { name: "eGFR (Estimated GFR)", cat: "Chemistry", range: "> 90 mL/min", use: "Kidney filtration rate", tube: "Calculated" },
        { name: "Uric Acid", cat: "Chemistry", range: "3.5-7.2 mg/dL", use: "Gout, Tumor lysis", tube: "Yellow (Serum)" },
        { name: "Total Protein", cat: "Chemistry", range: "6.0-8.3 g/dL", use: "Nutritional status, Liver", tube: "Yellow (Serum)" },
        { name: "Albumin", cat: "Chemistry", range: "3.5-5.5 g/dL", use: "Nutritional & Liver status", tube: "Yellow (Serum)" },
        { name: "Globulin", cat: "Chemistry", range: "2.0-3.5 g/dL", use: "Immune status, Liver", tube: "Calculated" },
        { name: "A/G Ratio", cat: "Chemistry", range: "1.0-2.1", use: "Liver disease marker", tube: "Calculated" },
        { name: "Total Bilirubin", cat: "Chemistry", range: "0.1-1.2 mg/dL", use: "Liver & Biliary function", tube: "Yellow (Serum)" },
        { name: "Direct (Conjugated) Bilirubin", cat: "Chemistry", range: "< 0.3 mg/dL", use: "Biliary obstruction", tube: "Yellow (Serum)" },
        { name: "Indirect Bilirubin", cat: "Chemistry", range: "0.2-0.8 mg/dL", use: "Hemolysis marker", tube: "Calculated" },
        { name: "AST (SGOT)", cat: "Chemistry", range: "10-40 U/L", use: "Liver & Muscle damage", tube: "Yellow (Serum)" },
        { name: "ALT (SGPT)", cat: "Chemistry", range: "7-56 U/L", use: "Specific Liver damage", tube: "Yellow (Serum)" },
        { name: "ALP (Alkaline Phosphatase)", cat: "Chemistry", range: "44-147 U/L", use: "Biliary & Bone disease", tube: "Yellow (Serum)" },
        { name: "GGT (Gamma GT)", cat: "Chemistry", range: "9-48 U/L", use: "Alcohol toxicity, Biliary", tube: "Yellow (Serum)" },
        { name: "Total Cholesterol", cat: "Lipids", range: "< 200 mg/dL", use: "Cardiovascular risk", tube: "Yellow (Serum)" },
        { name: "Triglycerides", cat: "Lipids", range: "< 150 mg/dL", use: "Metabolism, Heart risk", tube: "Yellow (Serum)" },
        { name: "HDL Cholesterol", cat: "Lipids", range: "> 40 mg/dL", use: "Good cholesterol", tube: "Yellow (Serum)" },
        { name: "LDL Cholesterol (Calc)", cat: "Lipids", range: "< 100 mg/dL", use: "Bad cholesterol risk", tube: "Yellow (Serum)" },
        { name: "VLDL Cholesterol", cat: "Lipids", range: "5-40 mg/dL", use: "Triglyceride rich lipoprotein", tube: "Calculated" },
        { name: "Sodium (Na)", cat: "Electrolytes", range: "136-145 mmol/L", use: "Fluid balance", tube: "Yellow/Green" },
        { name: "Potassium (K)", cat: "Electrolytes", range: "3.5-5.1 mmol/L", use: "Cardiac & Muscle function", tube: "Yellow/Green" },
        { name: "Chloride (Cl)", cat: "Electrolytes", range: "98-107 mmol/L", use: "Acid-base balance", tube: "Yellow/Green" },
        { name: "Bicarbonate (HCO3)", cat: "Electrolytes", range: "22-29 mmol/L", use: "Metabolic status", tube: "Green (Heparin)" },
        { name: "Anion Gap", cat: "Electrolytes", range: "3-11 mmol/L", use: "Metabolic acidosis cause", tube: "Calculated" },
        { name: "Calcium (Total)", cat: "Minerals", range: "8.5-10.2 mg/dL", use: "Bone & Parathyroid", tube: "Yellow (Serum)" },
        { name: "Calcium (Ionized)", cat: "Minerals", range: "4.6-5.3 mg/dL", use: "Active calcium status", tube: "Green (Heparin)" },
        { name: "Phosphorus (Phosphate)", cat: "Minerals", range: "2.5-4.5 mg/dL", use: "Bone & Kidney function", tube: "Yellow (Serum)" },
        { name: "Magnesium (Mg)", cat: "Minerals", range: "1.7-2.2 mg/dL", use: "Neuromuscular function", tube: "Yellow (Serum)" },
        { name: "CK (Creatine Kinase) Total", cat: "Cardiac/Muscle", range: "30-200 U/L", use: "Muscle damage", tube: "Yellow (Serum)" },
        { name: "CK-MB", cat: "Cardiac", range: "0-25 U/L", use: "Heart muscle damage", tube: "Yellow (Serum)" },
        { name: "Troponin I / T", cat: "Cardiac", range: "< 0.04 ng/mL", use: "Myocardial Infarction", tube: "Yellow/Green" },
        { name: "Myoglobin", cat: "Cardiac", range: "< 90 ng/mL", use: "Early muscle injury marker", tube: "Yellow (Serum)" },
        { name: "BNP (B-type Natriuretic Peptide)", cat: "Cardiac", range: "< 100 pg/mL", use: "Heart failure severity", tube: "Purple (EDTA)" },
        { name: "Amylase", cat: "Chemistry", range: "30-110 U/L", use: "Pancreatitis screening", tube: "Yellow (Serum)" },
        { name: "Lipase", cat: "Chemistry", range: "10-140 U/L", use: "Pancreatitis (Specific)", tube: "Yellow (Serum)" },
        { name: "Lactate (Lactic Acid)", cat: "Chemistry", range: "0.5-2.2 mmol/L", use: "Sepsis, Tissue hypoxia", tube: "Grey (Fluoride)" },
        { name: "Ammonia", cat: "Chemistry", range: "15-60 umol/L", use: "Liver failure", tube: "Green (Heparin - Ice)" },
        { name: "CRP (C-Reactive Protein)", cat: "Immunology", range: "< 10 mg/L", use: "Acute inflammation", tube: "Yellow (Serum)" },
        { name: "hs-CRP", cat: "Cardiac", range: "< 3 mg/L", use: "Cardiovascular risk", tube: "Yellow (Serum)" },
        { name: "Rheumatoid Factor (RF)", cat: "Immunology", range: "< 20 IU/mL", use: "Rheumatoid arthritis", tube: "Yellow (Serum)" },
        { name: "Anti-CCP", cat: "Immunology", range: "< 20 U/mL", use: "Rheumatoid arthritis (Specific)", tube: "Yellow (Serum)" },
        { name: "ASO Titer", cat: "Immunology", range: "< 200 IU/mL", use: "Streptococcal infection", tube: "Yellow (Serum)" },

        // --- HORMONES & ENDOCRINOLOGY ---
        { name: "TSH (Thyroid Stimulating Hormone)", cat: "Endocrinology", range: "0.4-4.0 mIU/L", use: "Thyroid function screen", tube: "Yellow (Serum)" },
        { name: "Free T4 (Thyroxine)", cat: "Endocrinology", range: "0.8-1.8 ng/dL", use: "Thyroid hormone status", tube: "Yellow (Serum)" },
        { name: "Total T4", cat: "Endocrinology", range: "4.5-12.5 mcg/dL", use: "Thyroid function", tube: "Yellow (Serum)" },
        { name: "Free T3 (Triiodothyronine)", cat: "Endocrinology", range: "2.3-4.2 pg/mL", use: "Active thyroid hormone", tube: "Yellow (Serum)" },
        { name: "Total T3", cat: "Endocrinology", range: "80-200 ng/dL", use: "Hyperthyroidism", tube: "Yellow (Serum)" },
        { name: "Anti-TPO", cat: "Immunology", range: "< 35 IU/mL", use: "Hashimoto's thyroiditis", tube: "Yellow (Serum)" },
        { name: "Thyroglobulin", cat: "Tumor Marker", range: "1.5-38 ng/mL", use: "Thyroid cancer monitoring", tube: "Yellow (Serum)" },
        { name: "Parathyroid Hormone (PTH)", cat: "Endocrinology", range: "10-65 pg/mL", use: "Calcium metabolism", tube: "Yellow (Serum)" },
        { name: "Cortisol (Morning)", cat: "Endocrinology", range: "6-23 mcg/dL", use: "Adrenal function", tube: "Yellow (Serum)" },
        { name: "ACTH", cat: "Endocrinology", range: "10-60 pg/mL", use: "Pituitary-Adrenal axis", tube: "Plastic (Ice)" },
        { name: "DHEA-Sulfate", cat: "Endocrinology", range: "Varies by age", use: "Adrenal androgen", tube: "Yellow (Serum)" },
        { name: "17-OH Progesterone", cat: "Endocrinology", range: "Follicular: < 1 ng/mL", use: "Congenital adrenal hyperplasia", tube: "Yellow (Serum)" },
        { name: "Aldosterone", cat: "Endocrinology", range: "Upright: 5-30 ng/dL", use: "Blood pressure regulation", tube: "Yellow (Serum)" },
        { name: "Renin Activity", cat: "Endocrinology", range: "Variable", use: "Hypertension workup", tube: "Plastic (Ice)" },
        { name: "FSH", cat: "Fertility", range: "Varies by cycle", use: "Ovarian/Testicular function", tube: "Yellow (Serum)" },
        { name: "LH", cat: "Fertility", range: "Varies by cycle", use: "Ovulation, Menopause", tube: "Yellow (Serum)" },
        { name: "Prolactin", cat: "Fertility", range: "< 25 ng/mL", use: "Pituitary function, Infertility", tube: "Yellow (Serum)" },
        { name: "Estradiol (E2)", cat: "Fertility", range: "Cycle dependent", use: "Ovarian function, IVF", tube: "Yellow (Serum)" },
        { name: "Progesterone", cat: "Fertility", range: "Luteal: > 5 ng/mL", use: "Ovulation confirmation", tube: "Yellow (Serum)" },
        { name: "Total Testosterone", cat: "Endocrinology", range: "Male: 270-1070 ng/dL", use: "Male hypogonadism", tube: "Yellow (Serum)" },
        { name: "Free Testosterone", cat: "Endocrinology", range: "Male: 9-30 pg/mL", use: "Bioavailable testosterone", tube: "Yellow (Serum)" },
        { name: "hCG (Total) - Qualitative", cat: "Fertility", range: "Positive/Negative", use: "Pregnancy test", tube: "Yellow/Urine" },
        { name: "hCG (Beta) - Quantitative", cat: "Fertility", range: "Non-preg: < 5 mIU/mL", use: "Pregnancy monitoring", tube: "Yellow (Serum)" },
        { name: "IGF-1 (Somatomedin C)", cat: "Endocrinology", range: "Age dependent", use: "Growth Hormone status", tube: "Yellow (Serum)" },
        { name: "Growth Hormone (GH)", cat: "Endocrinology", range: "Suppressed in adults", use: "Acromegaly, Deficiency", tube: "Yellow (Serum)" },
        { name: "Vitamin D (25-Hydroxy)", cat: "Vitamins", range: "30-100 ng/mL", use: "Bone health, Immunity", tube: "Yellow (Serum)" },
        { name: "Vitamin D (1,25-Dihydroxy)", cat: "Vitamins", range: "20-60 pg/mL", use: "Renal function, Calcium", tube: "Yellow (Serum)" },

        // --- TUMOR MARKERS ---
        { name: "CEA (Carcinoembryonic Antigen)", cat: "Tumor Marker", range: "< 5 ng/mL", use: "Colon, Lung, Breast cancer", tube: "Yellow (Serum)" },
        { name: "AFP (Alpha-Fetoprotein)", cat: "Tumor Marker", range: "< 10 ng/mL", use: "Liver cancer, Neural tube defects", tube: "Yellow (Serum)" },
        { name: "CA-125", cat: "Tumor Marker", range: "< 35 U/mL", use: "Ovarian cancer", tube: "Yellow (Serum)" },
        { name: "CA 19-9", cat: "Tumor Marker", range: "< 37 U/mL", use: "Pancreatic & Biliary cancer", tube: "Yellow (Serum)" },
        { name: "CA 15-3", cat: "Tumor Marker", range: "< 30 U/mL", use: "Breast cancer monitoring", tube: "Yellow (Serum)" },
        { name: "PSA (Total)", cat: "Tumor Marker", range: "< 4 ng/mL", use: "Prostate cancer screening", tube: "Yellow (Serum)" },
        { name: "PSA (Free)", cat: "Tumor Marker", range: "Ratio > 25%", use: "Prostate cancer specificity", tube: "Yellow (Serum)" },
        { name: "Free/Total PSA Ratio", cat: "Tumor Marker", range: "> 0.25", use: "Cancer vs BPH differentiation", tube: "Calculated" },
        { name: "Beta-2 Microglobulin", cat: "Tumor Marker", range: "1.2-2.5 mcg/mL", use: "Multiple Myeloma, Lymphoma", tube: "Yellow (Serum)" },
        { name: "NSE (Neuron Specific Enolase)", cat: "Tumor Marker", range: "< 12.5 ng/mL", use: "Small cell lung cancer", tube: "Yellow (Serum)" },
        { name: "HE4", cat: "Tumor Marker", range: "< 140 pmol/L", use: "Ovarian cancer (with CA125)", tube: "Yellow (Serum)" },
        { name: "Chromogranin A", cat: "Tumor Marker", range: "< 95 ng/mL", use: "Neuroendocrine tumors", tube: "Yellow (Serum)" },
        { name: "S100 Protein", cat: "Tumor Marker", range: "< 0.15 mcg/L", use: "Melanoma monitoring", tube: "Yellow (Serum)" },
        { name: "BTA (Bladder Tumor Antigen)", cat: "Tumor Marker", range: "Negative", use: "Bladder cancer screen", tube: "Urine" },
        { name: "NMP22", cat: "Tumor Marker", range: "< 10 U/mL", use: "Bladder cancer", tube: "Urine" },

        // --- IMMUNOLOGY & AUTOIMMUNE ---
        { name: "ANA (Antinuclear Antibody)", cat: "Immunology", range: "Titer < 1:40", use: "Autoimmune disease screen", tube: "Yellow (Serum)" },
        { name: "Anti-dsDNA", cat: "Immunology", range: "Negative", use: "Lupus (SLE) marker", tube: "Yellow (Serum)" },
        { name: "Anti-Smith (Anti-Sm)", cat: "Immunology", range: "Negative", use: "SLE specific marker", tube: "Yellow (Serum)" },
        { name: "Anti-SS-A (Ro)", cat: "Immunology", range: "Negative", use: "Sjogren's syndrome", tube: "Yellow (Serum)" },
        { name: "Anti-SS-B (La)", cat: "Immunology", range: "Negative", use: "Sjogren's syndrome", tube: "Yellow (Serum)" },
        { name: "Complement C3", cat: "Immunology", range: "90-180 mg/dL", use: "Immune activation, SLE", tube: "Yellow (Serum)" },
        { name: "Complement C4", cat: "Immunology", range: "10-40 mg/dL", use: "Immune activation, SLE", tube: "Yellow (Serum)" },
        { name: "CH50 (Total Complement)", cat: "Immunology", range: "30-75 U/mL", use: "Complement activity", tube: "Yellow (Serum)" },
        { name: "IgG", cat: "Immunology", range: "700-1600 mg/dL", use: "Immune deficiency/Infection", tube: "Yellow (Serum)" },
        { name: "IgA", cat: "Immunology", range: "70-400 mg/dL", use: "Mucosal immunity", tube: "Yellow (Serum)" },
        { name: "IgM", cat: "Immunology", range: "40-230 mg/dL", use: "Acute infection marker", tube: "Yellow (Serum)" },
        { name: "IgE", cat: "Immunology", range: "< 100 IU/mL", use: "Allergies, Parasites", tube: "Yellow (Serum)" },
        { name: "C1 Esterase Inhibitor", cat: "Immunology", range: "19-35 mg/dL", use: "Hereditary Angioedema", tube: "Yellow (Serum)" },
        { name: "Anti-MPO (p-ANCA)", cat: "Immunology", range: "Negative", use: "Vasculitis", tube: "Yellow (Serum)" },
        { name: "Anti-PR3 (c-ANCA)", cat: "Immunology", range: "Negative", use: "Wegener's granulomatosis", tube: "Yellow (Serum)" },
        { name: "Anti-GBM Antibody", cat: "Immunology", range: "Negative", use: "Goodpasture syndrome", tube: "Yellow (Serum)" },
        { name: "Anti-Jo-1", cat: "Immunology", range: "Negative", use: "Myositis, Polymyositis", tube: "Yellow (Serum)" },
        { name: "Anti-Scl-70", cat: "Immunology", range: "Negative", use: "Scleroderma (Diffuse)", tube: "Yellow (Serum)" },
        { name: "Anti-Centromere", cat: "Immunology", range: "Negative", use: "CREST syndrome", tube: "Yellow (Serum)" },
        { name: "ACE (Angiotensin Converting Enzyme)", cat: "Immunology", range: "9-67 U/L", use: "Sarcoidosis activity", tube: "Yellow (Serum)" },
        { name: "Cryoglobulins", cat: "Immunology", range: "Negative", use: "Vasculitis, Hep C", tube: "Red (Warm)" },
        { name: "HLA-B27", cat: "Histocompatibility", range: "Positive/Negative", use: "Ankylosing Spondylitis risk", tube: "Purple (EDTA)" },
        { name: "Anti-Mitochondrial Antibody (AMA)", cat: "Immunology", range: "Negative", use: "Primary Biliary Cholangitis", tube: "Yellow (Serum)" },
        { name: "Anti-Smooth Muscle Antibody (ASMA)", cat: "Immunology", range: "Negative", use: "Autoimmune Hepatitis", tube: "Yellow (Serum)" },

        // --- INFECTIOUS DISEASES & VIROLOGY ---
        { name: "HIV 1/2 Ab/Ag (4th Gen)", cat: "Serology", range: "Non-Reactive", use: "HIV Screening", tube: "Yellow (Serum)" },
        { name: "HIV Viral Load (PCR)", cat: "Molecular", range: "< 20 copies/mL", use: "Treatment monitoring", tube: "Purple (EDTA)" },
        { name: "Hepatitis B Surface Antigen (HBsAg)", cat: "Serology", range: "Non-Reactive", use: "Hepatitis B infection", tube: "Yellow (Serum)" },
        { name: "Hepatitis B Surface Antibody (Anti-HBs)", cat: "Serology", range: "> 10 mIU/mL (Immune)", use: "Immunity check", tube: "Yellow (Serum)" },
        { name: "Hepatitis B Core Antibody (Anti-HBc)", cat: "Serology", range: "Non-Reactive", use: "Past/Current infection", tube: "Yellow (Serum)" },
        { name: "HBV DNA Quantitative", cat: "Molecular", range: "< 20 IU/mL", use: "Treatment monitoring", tube: "Purple (EDTA)" },
        { name: "Hepatitis C Antibody (Anti-HCV)", cat: "Serology", range: "Non-Reactive", use: "Hepatitis C screening", tube: "Yellow (Serum)" },
        { name: "HCV RNA Quantitative", cat: "Molecular", range: "Not Detected", use: "Active infection, Treatment", tube: "Purple (EDTA)" },
        { name: "Hepatitis A Antibody (Total)", cat: "Serology", range: "Non-Reactive", use: "Past infection/Immunity", tube: "Yellow (Serum)" },
        { name: "Hepatitis A IgM", cat: "Serology", range: "Non-Reactive", use: "Acute Hepatitis A", tube: "Yellow (Serum)" },
        { name: "Rubella IgG", cat: "Serology", range: "Positive (>10 IU/mL)", use: "Immunity (MMR)", tube: "Yellow (Serum)" },
        { name: "Rubella IgM", cat: "Serology", range: "Non-Reactive", use: "Acute Infection", tube: "Yellow (Serum)" },
        { name: "CMV IgG", cat: "Serology", range: "Positive (Past Inf.)", use: "Immunity status", tube: "Yellow (Serum)" },
        { name: "CMV IgM", cat: "Serology", range: "Non-Reactive", use: "Acute/reactivated infection", tube: "Yellow (Serum)" },
        { name: "Toxoplasma IgG", cat: "Serology", range: "Positive (Past Inf.)", use: "Immunity status", tube: "Yellow (Serum)" },
        { name: "Toxoplasma IgM", cat: "Serology", range: "Non-Reactive", use: "Acute infection", tube: "Yellow (Serum)" },
        { name: "HSV 1 & 2 IgG", cat: "Serology", range: "Negative", use: "Past exposure", tube: "Yellow (Serum)" },
        { name: "HSV 1 & 2 IgM", cat: "Serology", range: "Negative", use: "Acute infection", tube: "Yellow (Serum)" },
        { name: "EBV VCA IgG", cat: "Serology", range: "Positive (Past Inf.)", use: "Mononucleosis history", tube: "Yellow (Serum)" },
        { name: "EBV VCA IgM", cat: "Serology", range: "Negative", use: "Acute Mononucleosis", tube: "Yellow (Serum)" },
        { name: "VZV (Varicella Zoster) IgG", cat: "Serology", range: "Positive (Immune)", use: "Chickenpox immunity", tube: "Yellow (Serum)" },
        { name: "Measles IgG", cat: "Serology", range: "Positive (Immune)", use: "Immunity check", tube: "Yellow (Serum)" },
        { name: "Mumps IgG", cat: "Serology", range: "Positive (Immune)", use: "Immunity check", tube: "Yellow (Serum)" },
        { name: "Syphilis (RPR/VDRL)", cat: "Serology", range: "Non-Reactive", use: "Screening for Syphilis", tube: "Yellow (Serum)" },
        { name: "Syphilis (TPPA/TPHA)", cat: "Serology", range: "Non-Reactive", use: "Confirmatory test", tube: "Yellow (Serum)" },
        { name: "Brucella (Standard Agglutination)", cat: "Serology", range: "< 1:80", use: "Brucellosis diagnosis", tube: "Yellow (Serum)" },
        { name: "Widal Test (Typhoid)", cat: "Serology", range: "Titer < 1:80", use: "Typhoid fever screening", tube: "Yellow (Serum)" },

        // --- URINE & MISCELLANEOUS ---
        { name: "Urinalysis (Complete)", cat: "Urine", range: "Normal", use: "UTI, Kidney disease screen", tube: "Urine Container" },
        { name: "Urine Culture", cat: "Microbiology", range: "No Growth", use: "UTI pathogen identification", tube: "Sterile Container" },
        { name: "24h Urine Protein", cat: "Urine", range: "< 150 mg/24h", use: "Nephrotic syndrome quant", tube: "24h Container" },
        { name: "24h Urine Creatinine", cat: "Urine", range: "Varies", use: "Muscle mass, Clearance", tube: "24h Container" },
        { name: "Microalbumin/Urine Albumin", cat: "Urine", range: "< 30 mg/g Creat", use: "Early diabetic nephropathy", tube: "Urine Container" },
        { name: "Urine Culture & Sensitivity", cat: "Microbiology", range: "No Growth", use: "Antibiotic selection", tube: "Sterile Container" },
        { name: "Urine Bence Jones Protein", cat: "Urine", range: "Negative", use: "Multiple Myeloma screening", tube: "Urine Container" },
        { name: "Stool Occult Blood (FOBT)", cat: "Stool", range: "Negative", use: "Colon cancer screen", tube: "Stool Container" },
        { name: "Stool Routine (Ova & Parasites)", cat: "Parasitology", range: "Negative", use: "Parasitic infection", tube: "Stool Container" },
        { name: "Semen Analysis", cat: "Fertility", range: "Count > 15M/mL", use: "Male fertility", tube: "Sterile Container" },
        { name: "Sweat Chloride", cat: "Chemistry", range: "< 40 mmol/L", use: "Cystic Fibrosis diagnosis", tube: "Sweat Collection" },
        { name: "CSF Analysis (Routine)", cat: "Body Fluids", range: "WBC < 5", use: "Meningitis diagnosis", tube: "Sterile Tube" },
        { name: "CSF Protein", cat: "Body Fluids", range: "15-45 mg/dL", use: "Blood-brain barrier integrity", tube: "Sterile Tube" },
        { name: "CSF Glucose", cat: "Body Fluids", range: "40-70 mg/dL", use: "Bacterial vs Viral Meningitis", tube: "Sterile Tube" },
        { name: "Pleural Fluid Analysis", cat: "Body Fluids", range: "Transudate/Exudate", use: "Pleural effusion cause", tube: "Heparin/Sterile" },
        { name: "Peritoneal Fluid Analysis", cat: "Body Fluids", range: "Transudate/Exudate", use: "Ascites cause", tube: "Heparin/Sterile" },
        { name: "Synovial Fluid Analysis", cat: "Body Fluids", range: "WBC < 200", use: "Arthritis types", tube: "Heparin/Sterile" },
        { name: "Drug Screen (Urine)", cat: "Toxicology", range: "Negative", use: "Substance abuse screen", tube: "Urine Container" },
        { name: "Blood Culture", cat: "Microbiology", range: "No Growth", use: "Sepsis diagnosis", tube: "Culture Bottles" },
        { name: "Lead (Blood)", cat: "Toxicology", range: "< 5 mcg/dL", use: "Lead poisoning", tube: "Royal Blue (EDTA)" },
        { name: "Zinc (Serum)", cat: "Trace Elements", range: "60-120 mcg/dL", use: "Deficiency/Toxicity", tube: "Royal Blue" },
        { name: "Copper (Serum)", cat: "Trace Elements", range: "70-140 mcg/dL", use: "Wilson's disease", tube: "Royal Blue" },
        { name: "Ceruloplasmin", cat: "Chemistry", range: "20-60 mg/dL", use: "Wilson's disease marker", tube: "Yellow (Serum)" },
        { name: "Alpha-1 Antitrypsin", cat: "Chemistry", range: "100-200 mg/dL", use: "Emphysema, Liver disease", tube: "Yellow (Serum)" },
        { name: "Lp(a) [Lipoprotein(a)]", cat: "Lipids", range: "< 30 mg/dL", use: "Cardiovascular risk", tube: "Yellow (Serum)" },
        { name: "Apolipoprotein A1", cat: "Lipids", range: "M: 119-240 mg/dL", use: "Protective lipid marker", tube: "Yellow (Serum)" },
        { name: "Apolipoprotein B", cat: "Lipids", range: "M: 55-130 mg/dL", use: "Atherogenic risk marker", tube: "Yellow (Serum)" }
    ];

    const ui = {
        ar: { title: "دليل المختبرات الشامل", sub: "دليل يضم أكثر من 300 فحص طبي", tabDir: "دليل الفحوصات", tabNews: "أخبار المختبرات", search: "ابحث عن الفحص (إنجليزي)...", footer: "اعداد أخصائي المختبرات مامون السعودي" },
        en: { title: "Comprehensive Lab Directory", sub: "Directory containing 300+ Medical Tests", tabDir: "Test Directory", tabNews: "Lab News", search: "Search Test...", footer: "Prepared by Lab Specialist Mamoun Al-Saudi" }
    };

    function toggleLanguage() {
        currentLang = (currentLang === 'ar') ? 'en' : 'ar';
        const html = document.getElementById('mainHtml');
        html.dir = (currentLang === 'ar') ? 'rtl' : 'ltr';
        document.getElementById('langBtn').innerText = (currentLang === 'ar') ? 'English' : 'العربية';
        document.getElementById('h1Title').innerText = ui[currentLang].title;
        document.getElementById('h1Sub').innerText = ui[currentLang].sub;
        document.getElementById('tabDir').innerText = ui[currentLang].tabDir;
        document.getElementById('tabNews').innerText = ui[currentLang].tabNews;
        document.getElementById('searchInput').placeholder = ui[currentLang].search;
        document.getElementById('footerText').innerText = ui[currentLang].footer;
        renderTests(directory);
    }

    function renderTests(data) {
        const grid = document.getElementById('testGrid');
        grid.innerHTML = data.map(t => `
            <div class="card">
                <h3>${t.name}</h3>
                <div class="info"><span class="label">Category:</span> <span>${t.cat}</span></div>
                <div class="info"><span class="label">Ref. Range:</span> <span>${t.range}</span></div>
                <div class="info"><span class="label">Clinical Use:</span> <span>${t.use}</span></div>
                <span class="tube-badge" style="background:${getTubeColor(t.tube)}">${t.tube}</span>
            </div>
        `).join('');
    }

    function getTubeColor(tube) {
        if(tube.includes("Purple")) return "#8e44ad";
        if(tube.includes("Yellow")) return "#f1c40f";
        if(tube.includes("Blue")) return "#3498db";
        if(tube.includes("Grey")) return "#7f8c8d";
        if(tube.includes("Green")) return "#27ae60";
        if(tube.includes("Red")) return "#e74c3c";
        if(tube.includes("Black")) return "#2c3e50";
        if(tube.includes("Urine") || tube.includes("Stool") || tube.includes("Sterile")) return "#e67e22";
        return "#475569";
    }

    function search() {
        const q = document.getElementById('searchInput').value.toLowerCase();
        const filtered = directory.filter(t => 
            t.name.toLowerCase().includes(q) || t.cat.toLowerCase().includes(q) || t.use.toLowerCase().includes(q) || t.tube.toLowerCase().includes(q)
        );
        renderTests(filtered);
    }

    async function fetchNews() {
        const newsGrid = document.getElementById('newsGrid');
        newsGrid.innerHTML = `<p style="text-align:center; grid-column:1/-1;">جاري تحميل الأخبار...</p>`;

        // استخدام RSS to JSON خدمة لجلب الأخبار بشكل موثوق
        // تم ضبط البحث على "المختبرات الطبية" و "Medical Laboratory"
        const query = (currentLang === 'ar') ? 'المختبرات+الطبية' : 'Medical+Laboratory';
        const rssUrl = `https://news.google.com/rss/search?q=${query}&hl=${currentLang}&gl=${currentLang === 'ar' ? 'SA' : 'US'}&ceid=${currentLang === 'ar' ? 'SA:ar' : 'US:en'}`;
        
        // خدمة تحويل RSS إلى JSON (api.rss2json.com)
        const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`;

        try {
            const res = await fetch(apiUrl);
            const data = await res.json();

            if (data.status === 'ok' && data.items.length > 0) {
                newsGrid.innerHTML = data.items.slice(0, 9).map(item => {
                    // استخراج اسم المصدر من الرابط أو العنوان
                    const sourceName = item.author || new URL(item.link).hostname.replace('www.', '');
                    
                    return `
                    <div class="news-card">
                        <span class="news-source">${sourceName}</span>
                        <h4>${item.title}</h4>
                        <p>${item.description ? item.description.replace(/<[^>]*>?/gm, '').substring(0, 100) + '...' : ''}</p>
                        <a href="${item.link}" target="_blank" class="news-link">
                            ${currentLang === 'ar' ? 'اقرأ الخبر كاملاً' : 'Read Full Article'}
                        </a>
                    </div>
                `}).join('');
            } else {
                throw new Error("No items");
            }
        } catch (e) {
            const fallbackMsg = currentLang === 'ar' ? 
                'تعذر تحميل الأخبار حالياً، يرجى المحاولة لاحقاً.' : 
                'Could not load news feed at the moment.';
            newsGrid.innerHTML = `<p style="text-align:center; grid-column:1/-1; color:red;">${fallbackMsg}</p>`;
        }
    }

    function showSec(sec, btn) {
        document.getElementById('dirSec').style.display = (sec === 'dir') ? 'block' : 'none';
        document.getElementById('newsSec').style.display = (sec === 'news') ? 'block' : 'none';
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        if(sec === 'news') fetchNews();
    }

    window.onload = () => {
        renderTests(directory);
        // بدء التشغيل باللغة العربية
        toggleLanguage(); 
        toggleLanguage(); 
    }
</script>
</body>
</html>
